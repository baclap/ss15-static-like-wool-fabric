<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../logo-loading/logo-loading.html">
<link rel="import" href="../movie-list/movie-list.html">
<link rel="import" href="../header-bar/header-bar.html">


<polymer-element name="main-content" attributes="">
    <template>

        <logo-loading fit layout vertical center center-justified hidden?="{{!show_loading}}"></logo-loading>
        <header-bar flex layout userInput="{{user_input}}" hidden?="{{show_loading}}"></header-bar>
        <movie-list layout vertical center searchUrl="{{searchUrl}}" hidden?="{{show_loading}}"></movie-list>
    </template>
    <script>
        (function () {
            Polymer('main-content', {
                show_loading: true,
                searchUrl:"http://api.themoviedb.org/3/movie/now_playing?api_key=053bc4c358ed49c08f6b0d197c632c49",
                ready: function() {
                    var self = this;
                    this.addEventListener('movies-loaded', function(e){
                        self.show_loading = false;
                    });
                    this.addEventListener('input-detected',function(e){
                        self.searchUrl="http://api.themoviedb.org/3/search/movie?api_key=053bc4c358ed49c08f6b0d197c632c49&query="+encodeURIComponent(this.user_input);
                    });
                    this.addEventListener('search-off', function(e){
                        self.searchUrl = "http://api.themoviedb.org/3/movie/now_playing?api_key=053bc4c358ed49c08f6b0d197c632c49"
                    });
                }
            });
        })();
    </script>
</polymer-element>